# 使用自定义的 Azure Speech SDK 基础镜像
# 首先需要构建基础镜像: docker build -f Dockerfile.base -t azure-speech-sdk:latest .
FROM azure-speech-sdk:latest

# 设置工作目录
WORKDIR /app

# 复制 API 项目文件
COPY api/ .

# 下载依赖并构建应用
RUN go mod tidy && \
    go build -o tts-api main.go

# 创建输出目录
RUN mkdir -p /app/output

# 设置环境变量
ENV OUTPUT_DIR=/app/output
ENV PORT=8080
ENV GIN_MODE=release

# 暴露端口
EXPOSE 8080

# 启动命令
CMD ["./tts-api"]